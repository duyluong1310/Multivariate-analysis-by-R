# Base R (no install needed):
# - stats::cmdscale → Classical MDS
# - MASS::isoMDS → Non-metric MDS

install.packages(c("MASS", "smacof", "ggplot2", "dplyr"))

library(MASS)      # isoMDS for non-metric MDS
library(smacof)    # More advanced MDS: metric/nonmetric, 3D plots, stress-plot
library(ggplot2)   # Visualization
library(dplyr)     # Data handling
data("USArrests")
df <- scale(na.omit(USArrests))

# Distance matrix (Euclidean)
dist_mat <- dist(df)
# k = number of dimensions
mds_classical <- cmdscale(dist_mat, k = 2, eig = TRUE)

# Coordinates (scores)
coords <- as.data.frame(mds_classical$points)
colnames(coords) <- c("Dim1", "Dim2")

# Plot
ggplot(coords, aes(x = Dim1, y = Dim2)) +
  geom_point(size = 3) +
  geom_text(aes(label = rownames(coords)), vjust = -0.5) +
  labs(title = "Classical MDS (Metric)") +
  theme_minimal()
# Non-metric MDS (requires initial config, often from cmdscale)
mds_nonmetric <- isoMDS(dist_mat, k = 2)

coords_nm <- as.data.frame(mds_nonmetric$points)
colnames(coords_nm) <- c("Dim1", "Dim2")

ggplot(coords_nm, aes(x = Dim1, y = Dim2)) +
  geom_point(size = 3) +
  geom_text(aes(label = rownames(coords_nm)), vjust = -0.5) +
  labs(title = "Non-metric MDS") +
  theme_minimal()
library(smacof)

# Metric MDS
smacof_metric <- mds(dist_mat, type = "interval", ndim = 2)
plot(smacof_metric)

# Non-metric MDS
smacof_nonmetric <- mds(dist_mat, type = "ordinal", ndim = 2)
plot(smacof_nonmetric)
plot(smacof_nonmetric, plot.type = "stressplot")
var_explained <- sum(mds_classical$eig[1:2]) / sum(mds_classical$eig)
var_explained
mds_nonmetric$stress
library(MASS)
library(smacof)
library(ggplot2)

data("USArrests")
df <- scale(na.omit(USArrests))
dist_mat <- dist(df)

# Classical MDS
mds_classical <- cmdscale(dist_mat, k = 2, eig = TRUE)
coords <- as.data.frame(mds_classical$points)
colnames(coords) <- c("Dim1", "Dim2")
ggplot(coords, aes(Dim1, Dim2)) + geom_point() +
  geom_text(aes(label = rownames(coords)), vjust = -0.5) +
  ggtitle("Classical MDS")

# Non-metric MDS
mds_nonmetric <- isoMDS(dist_mat, k = 2)
coords_nm <- as.data.frame(mds_nonmetric$points)
colnames(coords_nm) <- c("Dim1", "Dim2")
ggplot(coords_nm, aes(Dim1, Dim2)) + geom_point() +
  geom_text(aes(label = rownames(coords_nm)), vjust = -0.5) +
  ggtitle("Non-metric MDS")

# smacof metric
smacof_metric <- mds(dist_mat, type = "interval", ndim = 2)
plot(smacof_metric)

# smacof non-metric
smacof_nonmetric <- mds(dist_mat, type = "ordinal", ndim = 2)
plot(smacof_nonmetric)
